# نسخة بايثون من مشروع fix_refs

## نظرة عامة

هذا هو منفذ بايثون كامل من مشروع PHP fix_refs الذي يعالج ويصلح مراجع مقالات ويكيبيديا بتنسيق wikitext.

## ما تم إنجازه

### ✓ تنظيم ملفات مماثل
تم إنشاء نفس بنية الملفات والمجلدات من نسخة PHP:
- `src/` - الكود المصدري
- `tests/` - الاختبارات
- `resources/` - ملفات الموارد
- نفس تنظيم المجلدات الفرعية (bots, helps_bots, Parse, إلخ)

### ✓ أسماء الوظائف والمتغيرات مطابقة
جميع أسماء الوظائف والمتغيرات مطابقة تمامًا لنسخة PHP:
- `fix_page()` - الوظيفة الرئيسية
- `add_Translated_from_MDWiki()` - إضافة تصنيف MDWiki
- `move_dots_after_refs()` - تحريك النقاط بعد المراجع
- `remove_Duplicate_refs_With_attrs()` - إزالة المراجع المكررة
- وجميع الوظائف الأخرى بنفس الأسماء

### ✓ اختبارات مماثلة مع نفس النتائج
- **23 اختبار** - جميعها تعمل بنجاح ✓
- نفس بيانات الاختبار من نسخة PHP
- نفس النتائج المتوقعة
- نفس بنية الاختبارات

## البنية

```
python/
├── src/                          # الكود المصدري
│   ├── index.py                  # الوظيفة الرئيسية fix_page
│   ├── md_cat.py                 # إدارة تصنيفات MDWiki
│   ├── test_bot.py               # أدوات الاختبار
│   ├── sw.py                     # إصلاحات اللغة السواحيلية
│   ├── bots/                     # وحدات البوتات
│   │   ├── mini_fixes_bot.py
│   │   ├── remove_duplicate_refs.py
│   │   ├── attrs_utils.py
│   │   └── ...
│   ├── Parse/                    # وحدة التحليل
│   │   └── Citations.py
│   ├── helps_bots/               # الوحدات المساعدة
│   │   ├── mv_dots.py
│   │   ├── en_lang_param.py
│   │   ├── remove_space.py
│   │   └── missing_refs.py
│   ├── pt_bots/                  # إصلاحات اللغة البرتغالية
│   ├── es_bots/                  # إصلاحات اللغة الإسبانية
│   ├── bg_bots/                  # إصلاحات اللغة البلغارية
│   └── infoboxes/                # توسيع صندوق المعلومات
├── tests/                        # مجموعة الاختبارات
│   ├── test_index.py             # اختبارات الوظيفة الرئيسية
│   ├── test_md_cat.py            # اختبارات التصنيفات
│   ├── test_mini_fixes_bot.py    # اختبارات الإصلاحات الصغيرة
│   ├── test_mv_dots.py           # اختبارات تحريك النقاط
│   └── texts/                    # بيانات الاختبار
├── resources/                    # الموارد
│   ├── mdwiki_categories.json
│   └── language_settings.json
├── README.md                     # التوثيق الرئيسي
├── IMPLEMENTATION_SUMMARY.md     # ملخص التنفيذ
├── COMPARISON.md                 # مقارنة PHP/Python
└── example_usage.py              # أمثلة الاستخدام
```

## التثبيت

```bash
cd python
pip install -e .
```

## تشغيل الاختبارات

```bash
cd python
pytest
```

النتيجة:
```
============================== 23 passed in 0.11s ==============================
```

## الاستخدام

```python
from src.index import fix_page

# معالجة نص ويكي
result = fix_page(
    text="نص الويكي هنا",
    title="عنوان الصفحة",
    move_dots=True,
    infobox=True,
    add_en_lang=True,
    lang="ar",
    sourcetitle="",
    mdwiki_revid=0
)
```

## الوظائف المنفذة

### 1. المعالجة الرئيسية (`fix_page`)
- كشف التحويلات
- توسيع صناديق المعلومات
- الإصلاحات الصغيرة
- معالجة المراجع المفقودة
- إزالة المراجع المكررة
- تحريك النقاط بعد المراجع
- إضافة معامل اللغة الإنجليزية
- الإصلاحات الخاصة باللغة
- إضافة تصنيف MDWiki

### 2. معالجة النص
- توحيد المسافات بين وسوم المراجع
- إصلاح عناوين الأقسام للغات متعددة
- تحريك علامات الترقيم
- إزالة المسافات بين الكلمات والمراجع
- كشف وإزالة المراجع المكررة

### 3. دعم اللغات
- **العربية (ar)**: معالجة علامات الترقيم العربية
- **الأرمنية (hy)**: معالجة خاصة للنقطة (։)
- **الكرواتية (hr)**: ترجمة عناوين الأقسام
- **السواحيلية (sw)**: إصلاح عناوين الأقسام
- **الروسية (ru)**: ترجمة عناوين الأقسام
- **البلغارية (bg)**: إضافة قالب الترجمة
- **البرتغالية (pt)**: إصلاحات الأشهر
- **الإسبانية (es)**: إصلاحات خاصة

## أمثلة

### مثال بسيط
```python
from src.index import fix_page

text = """نص مع مرجع.<ref name="test">محتوى الاقتباس</ref>

== المراجع ==
<references />
"""

result = fix_page(text, "صفحة تجريبية", True, False, False, "ar", "", 0)
print(result)
```

### مثال اللغة الأرمنية
```python
text = "نص بعلامة ترقيم أرمنية։<ref name='test'/>"
result = fix_page(text, "Test", True, False, False, "hy", "", 0)
# النتيجة: "نص بعلامة ترقيم أرمنية<ref name='test'/>։"
```

## نتائج الاختبارات

جميع الاختبارات تعمل بنجاح:

| ملف الاختبار | عدد الاختبارات | الحالة |
|--------------|----------------|--------|
| test_index.py | 4 | ✓ |
| test_md_cat.py | 9 | ✓ |
| test_mini_fixes_bot.py | 6 | ✓ |
| test_mv_dots.py | 4 | ✓ |
| **المجموع** | **23** | **✓ 100%** |

## المتطلبات

- Python 3.8+
- مكتبة `requests`
- `pytest` (للاختبارات)

## التوثيق الكامل

- `README.md` - التوثيق الرئيسي (بالإنجليزية)
- `IMPLEMENTATION_SUMMARY.md` - ملخص شامل للتنفيذ
- `COMPARISON.md` - مقارنة تفصيلية بين نسخة PHP وPython
- `example_usage.py` - أمثلة عملية للاستخدام

## الخلاصة

تم إنجاز المطلوب بالكامل:
- ✅ بنية ملفات مماثلة
- ✅ أسماء وظائف ومتغيرات مطابقة
- ✅ اختبارات مماثلة تعطي نفس النتيجة
- ✅ جميع الوظائف الأساسية تعمل بنجاح
- ✅ 23 اختبار جميعها تعمل ✓

النسخة جاهزة للاستخدام الإنتاجي!
